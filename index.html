<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>‡§≠‡§æ‡§∞‡§§ ‡§∞‡§ø‡§Ø‡§≤-‡§ü‡§æ‡§á‡§Æ ‡§∞‡•Ç‡§ü ‡§™‡•ç‡§≤‡§æ‡§®‡§∞</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', sans-serif;
        }

        body {
            background: #f0f2f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            padding: 2rem;
            background: #2563eb;
            color: white;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        .search-box {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            display: flex;
            gap: 1rem;
        }

        input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
        }

        button {
            padding: 12px 2rem;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        button:hover {
            background: #1e40af;
        }

        #map {
            height: 500px;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .results {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #2563eb;
            display: none;
        }

        .error {
            background: #fee2e2;
            color: #dc2626;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            display: none;
        }

        .route-details div {
            padding: 1rem;
            margin: 1rem 0;
            background: #f8fafc;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‡§≠‡§æ‡§∞‡§§ ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§∞‡•Ç‡§ü ‡§™‡•ç‡§≤‡§æ‡§®‡§∞</h1>
            <p>‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§∏‡•ç‡§•‡§æ‡§® ‡§ï‡§æ ‡§≤‡§æ‡§á‡§µ ‡§∞‡•Ç‡§ü ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç</p>
        </div>

        <div class="search-box">
            <input type="text" id="start" placeholder="üö© ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠ ‡§∏‡•ç‡§•‡§≤ (‡§ú‡•à‡§∏‡•á: ‡§Æ‡•Å‡§Ç‡§¨‡§à)">
            <input type="text" id="end" placeholder="üèÅ ‡§ó‡§Ç‡§§‡§µ‡•ç‡§Ø ‡§∏‡•ç‡§•‡§≤ (‡§ú‡•à‡§∏‡•á: ‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä)">
            <button onclick="findRoute()">‡§∞‡•Ç‡§ü ‡§ñ‡•ã‡§ú‡•á‡§Ç</button>
        </div>

        <div class="loading" id="loading">‡§∞‡•Ç‡§ü ‡§ñ‡•ã‡§ú‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à... ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç ‚åõ</div>
        <div class="error" id="error"></div>
        <div id="map"></div>
        <div class="results" id="results"></div>
    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        let map;
        const RATE_PER_KM = 2;

        // Initialize Map
        function initMap() {
            map = L.map('map').setView([20.5937, 78.9629], 5);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);
        }

        // Show/Hide UI Elements
        function toggleLoader(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        function showError(message) {
            document.getElementById('error').style.display = 'block';
            document.getElementById('error').innerHTML = `‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${message}`;
        }

        // Main Function
        async function findRoute() {
            try {
                // Reset UI
                toggleLoader(true);
                document.getElementById('error').style.display = 'none';
                document.getElementById('results').innerHTML = '';
                map.eachLayer(layer => layer instanceof L.Polyline && map.removeLayer(layer));

                // Validate Input
                const startInput = document.getElementById('start').value.trim();
                const endInput = document.getElementById('end').value.trim();
                if(!startInput || !endInput) {
                    throw new Error('‡§ï‡•É‡§™‡§Ø‡§æ ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§∏‡•ç‡§•‡§æ‡§® ‡§≠‡§∞‡•á‡§Ç');
                }

                // Get Coordinates
                const start = await getCoordinates(startInput);
                const end = await getCoordinates(endInput);

                // Fetch Route
                const route = await fetchRoute(start, end);
                
                // Show Results
                showRouteOnMap(route);
                showRouteDetails(route);

            } catch(error) {
                showError(error.message);
                console.error('Error:', error);
            } finally {
                toggleLoader(false);
            }
        }

        // Geocoding Function
        async function getCoordinates(location) {
            try {
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(location)}`
                );
                const data = await response.json();
                
                if(!data || data.length === 0) {
                    throw new Error(`‡§∏‡•ç‡§•‡§æ‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ: "${location}"`);
                }
                
                return {
                    lat: parseFloat(data[0].lat),
                    lon: parseFloat(data[0].lon),
                    name: data[0].display_name
                };

            } catch(error) {
                throw new Error(`‡§∏‡•ç‡§•‡§æ‡§® ‡§¢‡•Ç‡§Ç‡§¢‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}`);
            }
        }

        // Fetch Route Data
        async function fetchRoute(start, end) {
            try {
                const response = await fetch(
                    `https://router.project-osrm.org/route/v1/driving/${start.lon},${start.lat};${end.lon},${end.lat}?overview=full`
                );
                const data = await response.json();
                
                if(data.code !== 'Ok' || !data.routes?.[0]) {
                    throw new Error('‡§∞‡•Ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ');
                }
                
                return data.routes[0];

            } catch(error) {
                throw new Error(`‡§∞‡•Ç‡§ü ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}`);
            }
        }

        // Display Route on Map
        function showRouteOnMap(route) {
            try {
                const coordinates = route.geometry.coordinates
                    .map(coord => [coord[1], coord[0]])
                    .filter(coord => coord[0] && coord[1]);

                if(coordinates.length === 0) {
                    throw new Error('‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§∞‡•Ç‡§ü ‡§°‡•á‡§ü‡§æ');
                }

                L.polyline(coordinates, {color: '#2563eb', weight: 4}).addTo(map);
                map.fitBounds(coordinates);

            } catch(error) {
                throw new Error(`‡§Æ‡§æ‡§®‡§ö‡§ø‡§§‡•ç‡§∞ ‡§™‡§∞ ‡§∞‡•Ç‡§ü ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}`);
            }
        }

        // Show Route Details
        function showRouteDetails(route) {
            try {
                const distance = (route.distance / 1000).toFixed(1);
                const time = (route.duration / 3600).toFixed(1);
                const fare = (distance * RATE_PER_KM).toFixed(0);

                document.getElementById('results').innerHTML = `
                    <div class="route-details">
                        <h2>‡§∞‡•Ç‡§ü ‡§µ‡§ø‡§µ‡§∞‡§£</h2>
                        <div>
                            <span>‡§ï‡•Å‡§≤ ‡§¶‡•Ç‡§∞‡•Ä:</span>
                            <strong>${distance} ‡§ï‡§ø‡§Æ‡•Ä</strong>
                        </div>
                        <div>
                            <span>‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§∏‡§Æ‡§Ø:</span>
                            <strong>${time} ‡§ò‡§Ç‡§ü‡•á</strong>
                        </div>
                        <div>
                            <span>‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ:</span>
                            <strong>‚Çπ${fare}</strong>
                        </div>
                    </div>
                `;

            } catch(error) {
                throw new Error(`‡§µ‡§ø‡§µ‡§∞‡§£ ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}`);
            }
        }

        // Initialize the Map
        initMap();
    </script>
</body>
</html>
